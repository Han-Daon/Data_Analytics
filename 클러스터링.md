# 클러스터링
---

### 1.1. 점, 공간, 거리
유클리드 공간의 점들은 실수로 구성된 벡터다.  
벡터의 길이는 그공간의 차원수다.  
벡터의 성분을 보통 점을 표현하는 좌표라고 한다.  

  
##### *점들 쌍에 적용되는 함수가 거리 측정 방법이 되기 위한 조건*
1. 거리는 항상 음수가 아니며, 하나의 접과 자기 자신의 거리는 0이다.
2. 거리는 대칭관계가 성립한다. 거리를 계산할 때 점들의 순서는 상관없다.
3. 거리 측정 방법은 삼각 부등식을 따른다. 즉 x에서 y를 거쳐 z에 이르는 거리는 x에서 z에 이르는 직접적인 거리보다 절대로 작을 수 없다

---
### 1.2. 클러스터링 전략

1. 계층적 병합적 알고리즘
    - 클러스터에 속한 각 점들에서 시작
    - 자신과 가까운 정도를 기준으로 결합
    - 이미 결정된 개수의 클러스터가 만들어졌을 때 결합 중단
    - 생성된 클러스터들의 점들이 너무 큰 범위에 흩어져 있는 경우
2. 점을 할당하는 방식
   - 점들에 특정 순서가 있다고 간주하고 할당
   - 유클리드 공간을 가정 알고리즘 : 점들의 집합이 센트로이드로 요약됨
   - 비유클리드 공간 알고리즘 : 센트로이드 개념 x
  
  ---------
### 1.3.차원의 저주

---
#### 2.1 유클리드 공간에서의 계층적 클러스터링
1. 클러스터는 어떻게 표현될것 인가?
2. 합쳐질 2개의 클러스터를 어떻게 선택할 것인가?
3. 클러스터 결합을 언제 멈출것인가?

##### *클러스터링을 중단하기 위한 방법*
1. 데이터에 클러스터가 얼마나 많이 존재하는지 알떼
2. 존재하는 클러스터들을 최적으로 결합했음에도 부적절한 클러스터가 생성될때
3. 오직 하나의 클러스터가 남았을 때
---
#### 2.2 계층적 클러스터링의 효율성
1. 모든 점 쌍들의 거리를 계산하는 것으로 시작.
2. 쌍들과 그들 사이의 거리를 우선순위 큐에 넣음 <- 언제든 최단거리를 찾을수 있게됨
3. 결합할 두 클러스터 c와 d를 결정할 때 이 두 클러스터 중 하나를 포함하는 우선수위 큐에서 모드 원소를 제거한다.
4. 새로운 클러스터와 남아 있는 클러스터들 사이의 모든 거리를 계산

 ==>O(n*3logn)

---
 #### 2.4 비계층적 공간에서 계층적 클러스터링
 비유클리드 공간에서는 수많은 점들을 해당 클러스터의 센트로이드로 대체할수 없다   
  ==> 비유클리드 공간일 때 하나의 클러스터에서 점들을 결합할 수 없다면, 가능한 방법은 클러스터에 속한 점들 중 하나를 선택해서 그 점이 해당 클러스터를 대표하게하는것
  ==> 대표 점을 "클러스트로이드" 라고한다
  - 클러스터 내에서 다른 점들까지의 거리의 합
  - 클러스터 내에서 다른 점들까지의 거리 최댓값
  - 클러스터 내에서 다른 점들까지의 거리를 제곱한 값들의 합
----

#### k-means 클러스터링 : 점 할당 알고리즘
유클리드 공간을 가정하고 클러스터 개수 k가 이미 알려진 상황이라 가정  

    서로다른 클러스터에 속할 가능성이 높은 k개의 점들을 초기에 선택하라;
    이런 점들이 클러스터들의 센트로이드가 되게 하라;
    FOR 남아 있는 각점 p에 대해 DO
       p에서 가장 가까운 센트로이드를 찾아라;
       p를 그 센트로이드의 클러스터에 추가하라;
       p를 반영해 그 클러스터의 센트로이드를 조정하라;
    END;   

#### k평균의 클러스터 초기화

1. 가능하면 서로 멀리 떨어져 있는 점들을 선택한다
2. 데이터 표본을 계층적으로 클러스터링헤서 k개의 클러스터를 만든다.
3. 각 클러스터에서 점 하나를 선택한다 <- 센트로이드에서 가장 가까운 점일것







